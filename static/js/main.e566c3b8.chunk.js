(this["webpackJsonppoap-viewer"]=this["webpackJsonppoap-viewer"]||[]).push([[0],{104:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n.n(r),c=n(53),i=n.n(c),s=n(25),o=n(12),u=(n(68),n(2)),l=n.n(u),d=n(26),h=n(13),j={xdai:"https://api.thegraph.com/subgraphs/name/poap-xyz/poap-xdai",eth:"https://api.thegraph.com/subgraphs/name/poap-xyz/poap"},f="https://api.poap.xyz",b={projectID:"1vqimhY3TeBrlMN8HyzToHj9kSP",key:"3df685885d0891c6a0d3b51cb777c934"};function v(e){var t=[];return e.forEach((function(e){var n={eventID:e.id,fancy_id:e.fancy_id,name:e.name,description:e.description,city:e.city,country:e.country,event_url:e.event_url,imageURL:e.image_url,year:e.year.toString(),start_date:e.start_date,timestampDate:Date.parse(e.start_date),virtual_event:e.virtual_event};t[e.id]=n})),t}var p=function(){var e=Object(r.useState)({alreadyFetched:!1,error:"",data:[]}),t=Object(h.a)(e,2),n=t[0],a=t[1],c=function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(f,"/events"));case 3:return t=e.sent,e.next=6,t.json();case 6:if(n=e.sent,t.ok){e.next=9;break}throw new Error(n);case 9:r=v(n),a({alreadyFetched:!0,error:"",data:r}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),a({alreadyFetched:!0,error:"there was an error fetching EVENTS from the API",data:[]});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return{events:n,fetchEvents:Object(r.useCallback)(c,[])}},O=(n(70),n(61)),x=function(e){return"".concat(e.slice(0,6),"...").concat(e.slice(-4))},m=function(e){return!!/^(0x)?[0-9a-f]{40}$/i.test(e)};function g(e){return new RegExp(/[a-z.0-9]{2,}.\.eth$/).test(e)}var y=function(){var e=Object(r.useState)({verified:!1,error:"",eth:"",ens:"",fancyEth:""}),t=Object(h.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(new O.a.providers.InfuraProvider("mainnet",{infura:{projectId:b.projectID,projectSecret:b.key}})),i=Object(h.a)(c,1)[0],s=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.toLowerCase(),!m(n)){e.next=14;break}return e.prev=2,e.next=5,i.lookupAddress(n);case 5:r=e.sent,a({verified:!0,error:"",eth:n,ens:r,fancyEth:x(n)}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),a({verified:!0,error:"",eth:n,ens:"",fancyEth:x(n)});case 12:e.next=28;break;case 14:if(e.prev=14,!g(n)){e.next=22;break}return e.next=18,i.resolveName(n);case 18:(c=e.sent)?(s=c.toLowerCase(),a({verified:!0,error:"",eth:s,ens:n,fancyEth:x(s)})):a({verified:!0,error:"The input is not an active ENS domain",eth:"",ens:"",fancyEth:""}),e.next=23;break;case 22:a({verified:!0,error:"The input is not a valid ETH address neither a valid ETH domain.",eth:"",ens:"",fancyEth:""});case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(14),a({verified:!0,error:"there was an error resolving the ETH domain",eth:"",ens:"",fancyEth:""});case 28:case"end":return e.stop()}}),e,null,[[2,9],[14,25]])})));return function(t){return e.apply(this,arguments)}}();return{account:n,setAccount:Object(r.useCallback)((function(e){return s(e)}),[])}},k=(n(82),n.p+"static/media/loading.41748e91.svg"),w=n(5);function E(){return Object(r.useEffect)((function(){var e=setTimeout((function(){return location.reload()}),5e3);return function(){return clearTimeout(e)}}),[]),Object(w.jsx)("div",{className:"Loading",children:Object(w.jsx)("img",{alt:"loading",src:k})})}function D(){var e=Object(o.f)(),t=y(),n=t.account,a=t.setAccount,c=Object(r.useState)(!1),i=Object(h.a)(c,2),s=i[0],u=i[1];return Object(r.useEffect)((function(){n.verified&&(u(!1),n.error||e.push("/scan/".concat(n.ens||n.eth)))}),[n]),s?Object(w.jsx)(E,{}):Object(w.jsxs)("div",{className:"EnterAddress",children:[Object(w.jsx)("p",{className:"error",children:n.error}),Object(w.jsxs)("p",{children:["The ",Object(w.jsx)("span",{children:"Proof of attendance protocol"})," (POAP) reminds you off the"," ",Object(w.jsx)("span",{children:"cool places"})," you\u2019ve been to."]}),Object(w.jsxs)("form",{onSubmit:function(e){e.preventDefault(),u(!0);var t=e.target.unverifiedAccount.value.trim();""!==t&&a(t)},children:[Object(w.jsx)("input",{className:"inputAddress",type:"text",name:"unverifiedAccount",id:"unverifiedAccount",placeholder:"vitalik.eth or 0xd8da6bf26964af9d7eed9e03e53415d37aa96045",maxLength:42,minLength:6,pattern:"[a-zA-Z0-9\\.]+",autoFocus:!0,required:!0}),Object(w.jsx)("input",{className:"submitButton",type:"submit",value:"Display Badges"})]})]})}var I=n(21),T=n(18);function S(e,t){var n=[];return t.account&&t.account.tokens.forEach((function(t){var r=parseInt(t.id,10),a=t.event.id;n.push({chain:e,tokenID:r,eventID:a})})),n}function F(e,t){return N.apply(this,arguments)}function N(){return(N=Object(d.a)(l.a.mark((function e(t,n){var r,a,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r='{account(id:"'.concat(n,'"){tokens(first:1000){id,event{id,tokenCount}}}}'),a={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:r})},e.next=4,fetch(t,a);case 4:return c=e.sent,e.next=7,c.json();case 7:if(i=e.sent,c.ok&&!(null===i||void 0===i?void 0:i.errors)){e.next=10;break}throw new Error(i);case 10:return e.abrupt("return",i.data);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _=function(){var e=Object(r.useState)({alreadyFetched:!1,error:"",data:[]}),t=Object(h.a)(e,2),n=t[0],a=t[1],c=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,c,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([F(j.eth,t),F(j.xdai,t)]);case 3:n=e.sent,r=Object(h.a)(n,2),c=r[0],i=r[1],s=[].concat(Object(T.a)(S("eth",c)),Object(T.a)(S("xdai",i))),a({alreadyFetched:!0,error:"",data:s}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),a({alreadyFetched:!0,error:"there was an error fetching TOKENS",data:[]});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}();return{tokens:n,getTokens:Object(r.useCallback)((function(e){return c(e)}),[])}},A=function(){var e=Object(r.useState)({alreadyFetched:!1,error:"",data:null}),t=Object(h.a)(e,2),n=t[0],a=t[1],c=function(){var e=Object(d.a)(l.a.mark((function e(t,n){var r,c,i,s,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(n.length>0)){e.next=7;break}r=n.filter((function(e){return e.tokenID===t})),c=r[0],a({alreadyFetched:!0,error:"",data:c}),e.next=17;break;case 7:return e.next=9,fetch("".concat(f,"/token/").concat(t));case 9:return i=e.sent,e.next=12,i.json();case 12:if(s=e.sent,i.ok&&!(null===s||void 0===s?void 0:s.statusCode)){e.next=15;break}throw new Error(s);case 15:u=s,o={tokenID:parseInt(u.tokenId,10),chain:"Layer2"===u.layer?"xdai":"eth",eventID:u.event.id,fancy_id:u.event.fancy_id,name:u.event.name,description:u.event.description,city:u.event.city,country:u.event.country,event_url:u.event.event_url,imageURL:u.event.image_url,year:u.event.year.toString(),start_date:u.event.start_date,timestampDate:0,virtual_event:!1,owner:u.owner},a({alreadyFetched:!0,error:"",data:o});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),a({alreadyFetched:!0,error:"there was an error fetching TOKEN",data:null});case 22:case"end":return e.stop()}var u}),e,null,[[0,19]])})));return function(t,n){return e.apply(this,arguments)}}();return{token:n,getToken:Object(r.useCallback)((function(e,t){return c(e,t)}),[])}},z=n(59);n(88);function C(e){var t=e.handleChangeToolbar;return Object(w.jsxs)("form",{className:"Toolbar",onChange:t,onSubmit:function(e){return e.preventDefault()},children:[Object(w.jsx)("input",{className:"search",type:"search",name:"searchInput",id:"searchInput",placeholder:"search by name, description or location"}),Object(w.jsxs)("label",{htmlFor:"chain",children:["Blockchain:",Object(w.jsxs)("select",{name:"chain",defaultValue:"all",children:[Object(w.jsx)("option",{value:"all",children:"All"}),Object(w.jsx)("option",{value:"eth",children:"ETH"}),Object(w.jsx)("option",{value:"xdai",children:"xDAI"})]})]}),Object(w.jsxs)("label",{htmlFor:"location",children:["Location:",Object(w.jsxs)("select",{name:"location",id:"location",defaultValue:"all",children:[Object(w.jsx)("option",{value:"all",children:"All"}),Object(w.jsx)("option",{value:"premises",children:"Premises"}),Object(w.jsx)("option",{value:"virtual",children:" Virtual"})]})]}),Object(w.jsxs)("label",{htmlFor:"size",children:["Size:",Object(w.jsxs)("select",{name:"size",id:"size",defaultValue:"large",children:[Object(w.jsx)("option",{value:"large",children:"Large"}),Object(w.jsx)("option",{value:"small",children:"Small"})]})]}),Object(w.jsxs)("label",{htmlFor:"sorting",children:["Sorting:",Object(w.jsxs)("select",{name:"sorting",id:"sorting",defaultValue:"newest",children:[Object(w.jsx)("option",{value:"newest",children:"Newest"}),Object(w.jsx)("option",{value:"oldest",children:"Oldest"})]})]})]})}n(89);var L=n(37),B=n.n(L);n(94);function R(e){var t=e.badge,n=t.imageURL,r=t.name,a=t.size,c=t.tokenID,i="large"===a?"240px":"140px";return Object(w.jsx)(s.b,{className:"link".concat(a),to:"/token/".concat(c),title:r,children:Object(w.jsx)(B.a,{height:i,resize:!0,style:{width:i},overflow:!0,offset:400,scrollContainer:".BadgeGroup",children:Object(w.jsx)("img",{className:"BadgeImage ".concat(a),src:n,alt:r,title:r})})})}function P(e){var t=e.badgeGroup;return setTimeout((function(){return Object(L.forceCheck)()}),50),Object(w.jsxs)("div",{className:"BadgeGroup",children:[Object(w.jsx)("h1",{children:t.title}),t.badges.map((function(e){return Object(w.jsx)(R,{badge:e},e.tokenID)}))]})}function H(e){var t=e.badgesToRender,n={},r=[],a=(new Date).setDate((new Date).getDate()-30);t.forEach((function(e){e.timestampDate>a?n.lastMonth?n.lastMonth.badges.push(e):(n.lastMonth={title:"Last 30 days",badges:[e]},r.push("lastMonth")):n[e.year]?n[e.year].badges.push(e):(n[e.year]={title:e.year,badges:[e]},r.push(e.year))}));var c=r.map((function(e){return n[e]}));return Object(w.jsx)(w.Fragment,{children:c.map((function(e){return Object(w.jsx)(P,{badgeGroup:e},e.title)}))})}n(95);var M=function(e,t,n){var r=e.searchInput,a=e.filters,c=e.sorting,i=e.size,s=U(r,n,t),o=function(e,t){return t.map((function(t){return Object(I.a)(Object(I.a)({},t),{},{size:e})}))}(i,G(s,a));return V(o,c)},V=function(e,t){if(e.length<=1)return e;var n=e.slice();return"newest"===t?n.sort((function(e,t){return t.timestampDate-e.timestampDate})):n.sort((function(e,t){return e.timestampDate-t.timestampDate}))},U=function(e,t,n){var r=e.trim();return r?n.search(r).map((function(e){return e.item})):t},G=function(e,t){return"all"!==t.chain||"all"!==t.location?e.filter((function(e){var n="virtual"===t.location;return(e.chain===t.chain||"all"===t.chain)&&(e.virtual_event===n||"all"===t.location)})):e};function q(e){var t=e.accountBadges,n=Object(r.useState)([]),a=Object(h.a)(n,2),c=a[0],i=a[1],s={filters:{chain:"all",location:"all"},searchInput:"",size:"large",sorting:"newest"},o=new z.a(t,{keys:["name","description","city","country","year","end_date"],shouldSort:!1,threshold:.2});return Object(r.useEffect)((function(){return i(M(s,o,t))}),[]),Object(w.jsxs)("div",{className:"AddressTokens",children:[Object(w.jsx)("p",{children:"You have attended ".concat(t.length," events in the past.")}),Object(w.jsx)(C,{handleChangeToolbar:function(e){e.preventDefault();var n=new FormData(e.target.form),r=Object.fromEntries(n.entries()),a={filters:{chain:r.chain,location:r.location},searchInput:r.searchInput,size:r.size,sorting:r.sorting};i(M(a,o,t))}}),t.length!==c.length&&c.length>0?Object(w.jsx)("p",{children:"Currently showing you only ".concat(c.length," badges based on your filters")}):null,c.length>0?Object(w.jsx)(H,{badgesToRender:c}):Object(w.jsx)("p",{children:"Currently not showing any results given your filters and search criteria."})]})}n(96);function J(e){var t=e.badgeToRender;return Object(w.jsx)("div",{className:"TokenDetails",children:t?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h1",{children:t.name}),Object(w.jsxs)("div",{className:"container",children:[Object(w.jsx)("img",{src:t.imageURL,alt:t.name}),Object(w.jsxs)("div",{className:"textContent",children:[Object(w.jsxs)("div",{className:"tokenInfo",children:[Object(w.jsx)("h3",{children:"Token"}),Object(w.jsx)("h4",{children:"ID"}),Object(w.jsx)("h6",{children:t.tokenID}),Object(w.jsx)("h4",{children:"Blockchain"}),Object(w.jsx)("h6",{children:t.chain}),Object(w.jsx)("h4",{children:"Owner"}),Object(w.jsx)("h6",{children:t.owner})]}),Object(w.jsxs)("div",{className:"eventInfo",children:[Object(w.jsx)("h3",{children:"Event"}),t.event_url?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h4",{children:"URL"}),Object(w.jsx)("h6",{children:t.event_url})]}):null,Object(w.jsx)("h4",{children:"Date"}),Object(w.jsx)("h6",{children:t.start_date}),Object(w.jsx)("h4",{children:"Location"}),Object(w.jsxs)("h6",{children:[t.city?"".concat(t.city,", "):null,t.country,t.virtual_event?" (virtual event)":null]}),t.description?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h4",{children:"Description"}),Object(w.jsx)("p",{children:t.description})]}):null]})]})]})]}):null})}n(97);function $(e){var t=e.error;return Object(w.jsx)("div",{className:"Error",children:Object(w.jsx)("h2",{children:t})})}n(98);var K=n(60),Y=n.n(K);function Z(e){var t=e.account,n=t.ens,r=t.fancyEth,a=t.eth,c=a?Y()(a):null;return Object(w.jsxs)(s.b,{className:"Profile",to:"/scan/".concat(n||a),title:"scan address",children:[c?Object(w.jsx)("img",{alt:"blockie",src:c}):null,Object(w.jsx)("h4",{children:n||r}),n?Object(w.jsxs)("h5",{children:["(",r,")"]}):null]})}function Q(e){var t=e.events,n=Object(r.useState)(!0),a=Object(h.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(""),u=Object(h.a)(s,2),l=u[0],d=u[1],j=Object(r.useState)([]),f=Object(h.a)(j,2),b=f[0],v=f[1],p=Object(r.useState)(),O=Object(h.a)(p,2),x=O[0],m=O[1],g=Object(r.useState)(),k=Object(h.a)(g,2),D=k[0],T=k[1],S=y(),F=S.account,N=S.setAccount,z=_(),C=z.tokens,L=z.getTokens,B=A(),R=B.token,P=B.getToken,H=Object(o.g)(),M=H.path,V=H.params;Object(r.useEffect)((function(){if("/scan/:unverifiedAccount"===M){var e=V.unverifiedAccount;e!==F.eth&&e!==F.ens?N(e):C.alreadyFetched||(i(!0),L(F.eth))}if("/token/:unverifiedTokenID"===M){var t=new RegExp("^\\d+$"),n=V.unverifiedTokenID;if(n!==(null===x||void 0===x?void 0:x.toString()))if(n&&t.test(n)){var r=parseInt(n,10);m(r)}else d("not a valid token ID"),i(!1)}}),[M]),Object(r.useEffect)((function(){"/scan/:unverifiedAccount"===M&&F.verified&&(F.error?(d(F.error),i(!1)):L(F.eth))}),[F]),Object(r.useEffect)((function(){x&&P(x,b)}),[x]),Object(r.useEffect)((function(){if(C.alreadyFetched&&t.alreadyFetched){if(C.error||t.error)d(C.error||t.error);else{var e=function(e,t,n){return 0===t.length?[]:t.map((function(t){var r=t.tokenID,a=t.chain,c=t.eventID;return Object(I.a)({owner:n,tokenID:r,chain:a},e[c])}))}(t.data,C.data,F.eth);0===e.length?d("no badges"):v(e)}i(!1)}}),[C,t]),Object(r.useEffect)((function(){R.alreadyFetched&&(R.error?d(R.error):(R.data&&N(R.data.owner),T(R.data)),i(!1))}),[R]);return c?Object(w.jsx)(E,{}):l?Object(w.jsx)($,{error:l}):"/scan/:unverifiedAccount"===M?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Z,{account:F}),Object(w.jsx)(q,{accountBadges:b})]}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Z,{account:F}),Object(w.jsx)(J,{badgeToRender:D})]})}var W=function(e){var t=e.match,n=p(),a=n.events,c=n.fetchEvents;return Object(r.useEffect)((function(){"/scan/"!==t.path&&"/"!==t.path||c()}),[]),Object(w.jsxs)(o.c,{children:[Object(w.jsx)(o.a,{path:"/scan/:unverifiedAccount",children:Object(w.jsx)(Q,{events:a})}),Object(w.jsx)(o.a,{path:"/token/:unverifiedTokenID",children:Object(w.jsx)(Q,{events:a})}),Object(w.jsx)(o.a,{path:"/",component:D})]})};i.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(s.a,{children:Object(w.jsx)(o.c,{children:Object(w.jsx)(o.a,{path:"/",component:W})})})}),document.getElementById("root"))},68:function(e,t,n){},70:function(e,t,n){},71:function(e,t){},79:function(e,t){},82:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){}},[[104,1,2]]]);
//# sourceMappingURL=main.e566c3b8.chunk.js.map